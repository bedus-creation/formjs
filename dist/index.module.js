import t from"axios";import e from"lodash.clonedeep";import r from"lodash.isequal";import{reactive as s,watch as n}from"vue";class o{visit(e,r){const s={method:"get",data:{},onSuccess:()=>{},onError:()=>{},onFinish:()=>{},...r};let n="string"==typeof e?function(t){return new URL(t.toString(),window.location.toString())}(e):e;const{onSuccess:o,onError:i,onFinish:a}=s;t({method:s.method,url:n.href,data:s.data}).then(t=>o(t)).catch(t=>{const e={};if(422===t.response?.status){const r=t.response.data.errors;Object.keys(r).forEach(t=>{e[t]=r[t][0]})}return i(e)}).then(()=>a())}get(t,e={},r={}){return this.visit(t,{...r,method:"get",data:e})}post(t,e={},r={}){return this.visit(t,{...r,method:"post",data:e})}put(t,e={},r={}){return this.visit(t,{...r,method:"put",data:e})}delete(t,e={}){return this.visit(t,{...e,method:"delete"})}}function i(t){return t instanceof File||t instanceof Blob||t instanceof FileList&&t.length>0||t instanceof FormData&&Array.from(t.values()).some(t=>i(t))||"object"==typeof t&&null!==t&&Object.values(t).some(t=>i(t))}function a(t,e=new FormData,r=null){t=t||{};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&u(e,c(r,s),t[s]);return e}function c(t,e){return t?t+"["+e+"]":e}function u(t,e,r){return Array.isArray(r)?Array.from(r.keys()).forEach(s=>u(t,c(e,s.toString()),r[s])):r instanceof Date?t.append(e,r.toISOString()):r instanceof File?t.append(e,r,r.name):r instanceof Blob?t.append(e,r):"boolean"==typeof r?t.append(e,r?"1":"0"):"string"==typeof r?t.append(e,r):"number"==typeof r?t.append(e,`${r}`):null==r?t.append(e,""):void a(r,t,e)}function h(){var t=[].slice.call(arguments);const c=("string"==typeof t[0]?t[1]:t[0])||{};let u=e(c),h=t=>t;const l=new o,d=s({...c,errors:{},isDirty:!1,processing:!1,transform(t){return h=t,this},data(){return Object.keys(c).reduce((t,e)=>(t[e]=this[e],t),{})},defaults(t,r){return u=void 0===t?this.data():Object.assign({},e(u),r?{[t]:r}:t),this},setError(t,e){return Object.assign(this.errors,e?{[t]:e}:t),this.hasErrors=Object.keys(this.errors).length>0,this},reset(){var t=[].slice.call(arguments);const r=e(u);return Object.assign(this,0===t.length?r:Object.keys(r).filter(e=>t.includes(e)).reduce((t,e)=>(t[e]=r[e],t),{})),this},clearErrors(){var t=[].slice.call(arguments);return this.errors=Object.keys(this.errors).reduce((e,r)=>({...e,...t.length>0&&!t.includes(r)?{[r]:this.errors[r]}:{}}),{}),this.hasErrors=Object.keys(this.errors).length>0,this},submit(t,e,r={}){const s=this;this.processing=!0;let n=h(this.data());!i(n)||n instanceof FormData||(n=a(n));const o={...r,onSuccess:function(t){try{function e(t){return s.isDirty=!1,t}return s.processing=!1,Promise.resolve(r.onSuccess?Promise.resolve(r.onSuccess(t)).then(e):e(null))}catch(n){return Promise.reject(n)}},onError:t=>{if(this.processing=!1,this.clearErrors().setError(t),r.onError)return r.onError(t)},onFinish:()=>{if(this.processing=!1,r.onFinish)return r.onFinish()}};"delete"===t?Inertia.delete(e,{...o,data:n}):l[t](e,n,o)},get(t,e){this.submit("post",t,e)},post(t,e){this.submit("post",t,e)},put(t,e){this.submit("put",t,e)},delete(t,e){this.submit("delete",t,e)}});return n(d,t=>{d.isDirty=!r(d.data(),u)},{immediate:!0,deep:!0}),d}const l=new o;export{l as Http,h as useForm};
//# sourceMappingURL=index.module.js.map
